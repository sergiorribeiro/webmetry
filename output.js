window.__webmetry={generateId:()=>Math.floor(65536*(1+Math.random())).toString(16).substring(1)};class WebmetryAxle{id;DOMElement;#config;#orientation;#offset;constructor(e,t){this.#config=t,this.#orientation=e,this.#offset={x:0,y:0},this.#createAxle(e)}#createAxle(){this.id=window.__webmetry.generateId();var e=document.createElement("div"),t=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div"),a=document.createElement("div");return"vertical"===this.#orientation?e.classList.add("wmy02f9c3d8e0cf356b","wmye19acd9b4bd21cae"):e.classList.add("wmy02f9c3d8e0cf356b","wmyd4989f1ab51440b4"),t.classList.add("wmyee88117682c37df6"),i.classList.add("wmy43fce9117cf24723","wmy8afb0b76cf5c931a"),o.classList.add("wmy43fce9117cf24723","wmy74c39539e0ec81dd"),a.classList.add("wmyf634f39ce62e444f"),t.style.background=this.#config.color,i.style.background=this.#config.gripColor,o.style.background=this.#config.gripColor,e.append(t,i,o,a),e.id=this.id,this.DOMElement=e,this}mouseMove(e){var t=this.DOMElement.querySelector(".wmyf634f39ce62e444f");"horizontal"===this.#orientation?(this.DOMElement.style.top=e.clientY-this.#offset.y+"px",t.innerHTML=e.clientY+"px",e.clientY>window.innerHeight/2?t.style.transform="translate(-50%, -150%)":t.style.transform="translate(-50%, 100%)"):(this.DOMElement.style.left=e.clientX-this.#offset.x+"px",t.innerHTML=e.clientX+"px",e.clientX>window.innerWidth/2?t.style.transform="translate(-150%, -50%)":t.style.transform="translate(50%, -50%)")}mouseDown(e){this.#offset={x:e.offsetX,y:e.offsetY}}}class WebmetryGrid{id;DOMElement;#config;constructor(e){this.id=window.__webmetry.generateId(),this.#config=e;const a=document.createElement("div");return a.classList.add("wmya945ad4e9421f054"),e.breakpoints.forEach(t=>{var i=document.createElement("div"),e=i.style;i.classList.add("wmy3cd625ea419d9935"),i.dataset.until=t.until,e.margin=t.margin;for(let e=1;e<=t.columns;e++){1<e&&((o=document.createElement("div")).classList.add("wmy6daf4d33f692c6a4"),o.style.width=t.gutter,o.style.background=t.gutterColor,i.appendChild(o));var o=document.createElement("div");o.classList.add("wmy356f11cf737ce704"),o.style.width=100/t.columns+"%",o.style.background=t.columnColor,i.appendChild(o)}a.appendChild(i)}),a.id=this.id,this.DOMElement=a,this.windowResized(),this}windowResized(){var t=window.innerWidth,i=this.#config.breakpoints.map(e=>parseInt(e.until));i.sort,i.unshift(0),this.DOMElement.querySelectorAll(".wmy3cd625ea419d9935[data-until]").forEach(e=>{e.classList.remove("wmy12c34c14bcc26af7")});for(let e=0;e<i.length-1;e++){var o=i[e],a=i[e+1];if(o<=t&&t<=a){this.DOMElement.querySelector(`.wmy3cd625ea419d9935[data-until='${a}']`).classList.add("wmy12c34c14bcc26af7");break}}}}class WebmetryMeasurementTape{id;DOMElement;#config;#DOMgripA;#DOMgripB;#connector;#offset;#currentGrip;#points;#aBase;#bBase;constructor(e){this.id=window.__webmetry.generateId(),this.#config=e,this.#points={a:{x:0,y:0},b:{x:0,y:0}};var e=document.createElement("div"),t=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div"),a=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div"),l=document.createElement("div"),m=document.createElement("div"),f=document.createElement("div"),b=document.createElement("div");return e.classList.add("wmy03de5204250ecf75"),t.classList.add("wmy43fce9117cf24723","wmy8afb0b76cf5c931a"),i.classList.add("wmy43fce9117cf24723","wmy74c39539e0ec81dd"),o.classList.add("wmybcc2b2110e02c19b","wmye19acd9b4bd21cae","wmy119cc60bca822302"),a.classList.add("wmybcc2b2110e02c19b","wmyd4989f1ab51440b4","wmy119cc60bca822302"),s.classList.add("wmybcc2b2110e02c19b","wmye19acd9b4bd21cae","wmy1fe1bd1af793a49c"),n.classList.add("wmybcc2b2110e02c19b","wmyd4989f1ab51440b4","wmy1fe1bd1af793a49c"),c.classList.add("wmybcc2b2110e02c19b","wmye19acd9b4bd21cae","wmy119cc60bca822302"),d.classList.add("wmybcc2b2110e02c19b","wmyd4989f1ab51440b4","wmy119cc60bca822302"),r.classList.add("wmybcc2b2110e02c19b","wmye19acd9b4bd21cae","wmy1fe1bd1af793a49c"),l.classList.add("wmybcc2b2110e02c19b","wmyd4989f1ab51440b4","wmy1fe1bd1af793a49c"),m.classList.add("wmy0f5897583fa25a31","wmy8afb0b76cf5c931a"),f.classList.add("wmy0f5897583fa25a31","wmy74c39539e0ec81dd"),b.classList.add("wmy3ac7ef83012ed22f"),b.style.background=this.#config.tapeColor,t.style.background=this.#config.gripColor,i.style.background=this.#config.gripColor,[o,a,c,d].forEach(e=>{e.style.background=this.#config.fixedGuideColor}),[s,n,r,l].forEach(e=>{e.style.background=this.#config.orientedGuideColor}),m.append(n,s),f.append(l,r),t.append(a,o,m),i.append(d,c,f),e.append(t,i,b),e.id=this.id,this.DOMElement=e,this.#DOMgripA=t,this.#DOMgripB=i,this.#connector=b,this.#aBase=m,this.#bBase=f,this}forceMove(e,t,i){this.#offset={x:0,y:0},this.#currentGrip=e,this.mouseMove({clientX:t,clientY:i})}mouseDown(e){this.#offset={x:e.offsetX,y:e.offsetY},this.#currentGrip=e.target.classList.contains("wmy8afb0b76cf5c931a")?"a":"b",e.target.classList.add("wmyee5bb57b8e09c8e6")}mouseUp(e){[this.#DOMgripA,this.#DOMgripB].forEach(e=>{e.classList.remove("wmyee5bb57b8e09c8e6")})}mouseMove(e){this.#points[this.#currentGrip]={x:e.clientX-this.#offset.x,y:e.clientY-this.#offset.y},this.#update()}#update(){var e=this.#points,t="a"===this.#currentGrip?this.#DOMgripA:this.#DOMgripB,i=t.clientWidth/2,o=e[this.#currentGrip],a=this.#connector.style,t=(t.style.left=o.x-i+"px",t.style.top=o.y-i+"px",{}),o=(e.a.y>e.b.y?(t.top=e.b,t.bottom=e.a):(t.top=e.a,t.bottom=e.b),e.a.x>e.b.x?(t.left=e.b,t.right=e.a):(t.left=e.a,t.right=e.b),t.right.x-t.left.x),i=t.bottom.y-t.top.y,c=Math.abs(e.b.x-e.a.x),e=Math.abs(e.b.y-e.a.y);const d=180*Math.atan2(e,c)/Math.PI;for(;360<=d;)d-=360;for(;d<0;)d+=360;c=Math.sqrt(Math.pow(c,2)+Math.pow(e,2));a.width=c+"px",a.top=t.top.y+i/2+"px",a.left=t.left.x+o/2+"px",a.transform=`translate(-50%, -50%) rotate(${t.top.x>t.left.x?-d:d}deg)`,d*=t.top.x>t.left.x?-1:1,this.#aBase.style.transform=`rotate(${d}deg)`,this.#bBase.style.transform=`rotate(${d}deg)`,this.#connector.dataset.angle=Math.round(Math.abs(d),2)+"Â°",this.#connector.dataset.distance=Math.round(c,1)+"px"}}class Webmetry{#tools;#overlay;#config;#holdData;#lastInteractedTool;#fixedGrid;#infoElement;constructor(){this.#tools={},this.#holdData=null,this.#lastInteractedTool=null,this.#fixedGrid=null,this.#buildConfig(),this.#install()}toggleGrid(){var e;null===this.#fixedGrid?(e=new WebmetryGrid(this.#config.grid),this.#overlay.appendChild(e.DOMElement),this.#tools[e.id]=e,this.#fixedGrid=e):(this.#fixedGrid.DOMElement.remove(),delete this.#tools[this.#fixedGrid.id],this.#fixedGrid=null)}addAxleSet(){var e=new WebmetryAxle("vertical",this.#config.axle),e=(this.#overlay.appendChild(e.DOMElement),this.#tools[e.id]=e,new WebmetryAxle("horizontal",this.#config.axle));this.#overlay.appendChild(e.DOMElement),this.#tools[e.id]=e}addMeasurementTape(){var e=window.innerWidth/2,t=window.innerHeight/2,i=new WebmetryMeasurementTape(this.#config.measurementTape);this.#overlay.appendChild(i.DOMElement),(this.#tools[i.id]=i).forceMove("a",e-100,t),i.forceMove("b",100+e,t)}#windowResized(){Object.keys(this.#tools).forEach(e=>{e=this.#tools[e];e instanceof WebmetryGrid&&e.windowResized()})}#mouseMove(e){var t;null!==this.#holdData&&"function"==typeof(t=this.#tools[this.#holdData.toolId]).mouseDown&&t.mouseMove(e)}#mouseUp(t){null!==this.#holdData?this.#lastInteractedTool=this.#tools[this.#holdData.toolId]:this.#lastInteractedTool=null,Object.keys(this.#tools).forEach(e=>{e=this.#tools[e];"function"==typeof e.mouseUp&&e.mouseUp(t)}),this.#holdData=null}#mouseDown(t){if(t.target.classList.contains("wmy43fce9117cf24723")){let e=t.target.parentElement;for(;""===e.id;){var i=e.parentElement;if(null===i)return;e=i}var o=this.#tools[e.id];"function"==typeof o.mouseDown&&o.mouseDown(t),this.#holdData={element:t.target,toolId:e.id}}}#keyPressed(e){if(e.ctrlKey||e.shiftKey)switch(e.key){case"O":var t=this.#overlay.classList;t.contains("wmy12c34c14bcc26af7")?t.remove("wmy12c34c14bcc26af7"):t.add("wmy12c34c14bcc26af7");break;case"A":this.addAxleSet();break;case"T":this.addMeasurementTape();break;case"G":this.toggleGrid();break;case"R":null!==this.#lastInteractedTool&&(t=this.#lastInteractedTool.id,this.#lastInteractedTool.DOMElement.remove(),delete this.#tools[t])}}#configToObject(e){let t={};return e.split(";").forEach(e=>{e=e.split(":");t[(e[0]||"").trim()]=(e[1]||"").trim()}),t}#buildConfig(){var e=this.#configToObject(document.currentScript.dataset?.axleConfig),t=(this.#configToObject(document.currentScript.dataset?.measurementTapeConfig),(document.currentScript.dataset?.gridConfig||"").split("|").map(e=>{e=this.#configToObject(e);return{until:e.until||800,columns:e.columns||12,gutter:e.gutter||"4px",margin:e.margin||"2px",gutterColor:e.gutterColor||"rgba(0,0,0,.6)",columnColor:e.columnColor||"rgba(0,0,0,.4)"}}));this.#config={grid:{breakpoints:t},axle:{color:e.axleColor||"rgba(0,0,0,.3)",gripColor:e.gripColor||"rgba(190,0,0,1)"},measurementTape:{tapeColor:e.tapeColor||"rgba(0,0,0,.3)",gripColor:e.gripColor||"rgba(190,0,0,.3)",fixedGuideColor:e.fixedGuideColor||"rgba(190,0,0,.8)",orientedGuideColor:e.orientedGuideColor||"rgba(0,0,190,.8)"}}}#install(){this.#overlay=document.createElement("div"),this.#overlay.classList.add("wmyf46f53004040c229","wmy12c34c14bcc26af7"),document.body.appendChild(this.#overlay);var e=document.createElement("style");e.innerHTML=".wmyf46f53004040c229,.wmya945ad4e9421f054,.wmy3cd625ea419d9935,.wmy03de5204250ecf75 {   position: fixed;   top: 0; left: 0; right: 0; bottom: 0; }  .wmyf46f53004040c229 * {   user-select: none; }  .wmyf46f53004040c229 {   z-index: 9999999;   display: none; }  .wmyf46f53004040c229.wmy12c34c14bcc26af7 {   display: block; }  .wmya945ad4e9421f054 {   pointer-events: none;   z-index: 500; }  .wmy3cd625ea419d9935 {   display: flex;   opacity: 0; }  .wmy3cd625ea419d9935.wmy12c34c14bcc26af7 {   opacity: 1; }  .wmy02f9c3d8e0cf356b {   position: fixed;   user-select: none;   z-index: 600; }  .wmy02f9c3d8e0cf356b.wmyd4989f1ab51440b4 {   top: 0; left: 0; right: 0;   height: 10px; }  .wmy02f9c3d8e0cf356b.wmye19acd9b4bd21cae {   top: 0; left: 0; bottom: 0;   width: 10px; }  .wmyee88117682c37df6, .wmy43fce9117cf24723 {   position: absolute; }  .wmyee88117682c37df6 {   z-index: 100; }  .wmy43fce9117cf24723 {   pointer-events: all;   cursor: pointer;   z-index: 200; }  .wmy02f9c3d8e0cf356b.wmyd4989f1ab51440b4 .wmyee88117682c37df6 {   top: 50%; left: 0; right: 0;   transform: translateY(-50%);   height: 1px;   mix-blend-mode: difference; }  .wmy02f9c3d8e0cf356b.wmye19acd9b4bd21cae .wmyee88117682c37df6 {   top: 0; left: 50%; bottom: 0;   transform: translateX(-50%);   width: 1px;   mix-blend-mode: difference; }  .wmy02f9c3d8e0cf356b.wmyd4989f1ab51440b4 .wmy43fce9117cf24723 {   top: 0; bottom: 0;   width: 8px;   mix-blend-mode: difference; }  .wmy02f9c3d8e0cf356b.wmye19acd9b4bd21cae .wmy43fce9117cf24723 {   left: 0; right: 0;   height: 8px;   mix-blend-mode: difference; }  .wmy02f9c3d8e0cf356b.wmyd4989f1ab51440b4 .wmy43fce9117cf24723.wmy8afb0b76cf5c931a {   left: 0;   border-top-right-radius: 3px;   border-bottom-right-radius: 3px; }  .wmy02f9c3d8e0cf356b.wmyd4989f1ab51440b4 .wmy43fce9117cf24723.wmy74c39539e0ec81dd {   right: 0;   border-top-left-radius: 3px;   border-bottom-left-radius: 3px; }  .wmy02f9c3d8e0cf356b.wmye19acd9b4bd21cae .wmy43fce9117cf24723.wmy8afb0b76cf5c931a {   top: 0;   border-bottom-left-radius: 3px;   border-bottom-right-radius: 3px; }  .wmy02f9c3d8e0cf356b.wmye19acd9b4bd21cae .wmy43fce9117cf24723.wmy74c39539e0ec81dd {   bottom: 0;   border-top-left-radius: 3px;   border-top-right-radius: 3px; }  .wmy02f9c3d8e0cf356b .wmyf634f39ce62e444f {   pointer-events: none;   display: inline-block;   position: absolute;   font-family: monospace;   font-size: 8px;   color: black;   mix-blend-mode: difference;   top: 50%;   left: 50%;   transition: transform 200ms 50ms ease-in-out; }  .wmy02f9c3d8e0cf356b.wmye19acd9b4bd21cae .wmyf634f39ce62e444f {   top: 50%; }  .wmy02f9c3d8e0cf356b.wmyd4989f1ab51440b4 .wmyf634f39ce62e444f {   left: 50%; }  .wmy03de5204250ecf75 {   pointer-events: none;   z-index: 700; }  .wmy03de5204250ecf75 .wmy43fce9117cf24723 {   border-radius: 50%;   opacity: 0.3;   width: 8px;   height: 8px;   position: absolute; }  .wmy03de5204250ecf75 .wmy43fce9117cf24723.wmyee5bb57b8e09c8e6 .wmybcc2b2110e02c19b.wmy119cc60bca822302 {   width: 80px;   opacity: 1; }  .wmy03de5204250ecf75 .wmy43fce9117cf24723.wmyee5bb57b8e09c8e6 .wmybcc2b2110e02c19b.wmy1fe1bd1af793a49c {   width: 100vw;   opacity: 1; }  .wmy03de5204250ecf75 .wmy3ac7ef83012ed22f {   position: absolute;   height: 1px;   transform-origin: center center; }  .wmy03de5204250ecf75 .wmy3ac7ef83012ed22f::after, .wmy03de5204250ecf75 .wmy3ac7ef83012ed22f::before {   display: block;   position: absolute;   left: 50%;   transform: translateX(-50%);   font-family: monospace;   font-size: 8px;   mix-blend-mode: difference; }  .wmy03de5204250ecf75 .wmy3ac7ef83012ed22f::after {   bottom: 4px;   content: attr(data-angle); }  .wmy03de5204250ecf75 .wmy3ac7ef83012ed22f::before {   top: 4px;   content: attr(data-distance); }  .wmy03de5204250ecf75 .wmybcc2b2110e02c19b {   position: absolute;   height: 1px;   mix-blend-mode: difference;   width: 25px;   top: 50%;   left: 50%;   transform: translate(-50%, -50%);   pointer-events: none;   opacity: 0.5;   transition: width 150ms ease-in-out, height 150ms ease-in-out, opacity, 150ms ease-in-out; }  .wmy03de5204250ecf75 .wmybcc2b2110e02c19b.wmye19acd9b4bd21cae {   transform: translate(-50%, -50%) rotate(90deg); }  .wmy03de5204250ecf75 .wmy0f5897583fa25a31 {   position: absolute;   width: 100%;   height: 100%;   pointer-events: none; }  .wmy990d67f3b762e7df {   position: fixed;   bottom: 4px;   left: 4px;   color: black;   mix-blend-mode: difference;   font-family: monospace;   font-size: 10px; }",document.body.appendChild(e),window.addEventListener("resize",this.#windowResized.bind(this)),document.addEventListener("mousemove",this.#mouseMove.bind(this)),document.addEventListener("mouseup",this.#mouseUp.bind(this)),document.addEventListener("mousedown",this.#mouseDown.bind(this)),window.addEventListener("keyup",this.#keyPressed.bind(this)),this.#infoElement=document.createElement("div"),this.#infoElement.classList.add("wmy990d67f3b762e7df"),this.#infoElement.innerHTML="<b>webmetry</b> availale<br/><br/>",this.#infoElement.innerHTML+="<b>CTRL+SHIFT+O:</b> Toggle overlay<br/>",this.#infoElement.innerHTML+="<b>CTRL+SHIFT+A:</b> Add axles set<br/>",this.#infoElement.innerHTML+="<b>CTRL+SHIFT+T:</b> Add measurement tape<br/>",this.#infoElement.innerHTML+="<b>CTRL+SHIFT+G:</b> Toggle grid<br/>",this.#infoElement.innerHTML+="<b>CTRL+SHIFT+R:</b> Remove last interacted tool",document.body.appendChild(this.#infoElement),window.setTimeout(()=>{this.#infoElement.remove()},5e3)}}window.__webmetry.core=new Webmetry;