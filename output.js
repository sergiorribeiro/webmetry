window.__webmetry={generateId:()=>Math.floor(65536*(1+Math.random())).toString(16).substring(1)};class WebmetryAxle{id;DOMElement;#config;#orientation;#offset;constructor(e,t){this.#config=t,this.#orientation=e,this.#offset={x:0,y:0},this.#createAxle(e)}#createAxle(){this.id=window.__webmetry.generateId();var e=document.createElement("div"),t=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div"),a=document.createElement("div");return"vertical"===this.#orientation?e.classList.add("wmye97e6d5692db2111","wmy03a518dbd7620fc7"):e.classList.add("wmye97e6d5692db2111","wmy149ba45d98b0dec2"),t.classList.add("wmycd7070bb1d3b5af9"),i.classList.add("wmy01618e03436f8fe0","wmy7fee32216e57e354"),o.classList.add("wmy01618e03436f8fe0","wmy3b5243bcbb9ff2fb"),a.classList.add("wmy5f95c9d751a2afd5"),t.style.background=this.#config.color,i.style.background=this.#config.gripColor,o.style.background=this.#config.gripColor,e.append(t,i,o,a),e.id=this.id,this.DOMElement=e,this}mouseMove(e){var t=this.DOMElement.querySelector(".wmy5f95c9d751a2afd5");"horizontal"===this.#orientation?(this.DOMElement.style.top=e.clientY-this.#offset.y+"px",t.innerHTML=e.clientY+"px",e.clientY>window.innerHeight/2?t.style.transform="translate(-50%, -150%)":t.style.transform="translate(-50%, 100%)"):(this.DOMElement.style.left=e.clientX-this.#offset.x+"px",t.innerHTML=e.clientX+"px",e.clientX>window.innerWidth/2?t.style.transform="translate(-150%, -50%)":t.style.transform="translate(50%, -50%)")}mouseDown(e){this.#offset={x:e.offsetX,y:e.offsetY}}}class WebmetryGrid{id;DOMElement;#config;constructor(e){this.id=window.__webmetry.generateId(),this.#config=e;const a=document.createElement("div");return a.classList.add("wmyc18698ef93e5c70f"),e.breakpoints.forEach(t=>{var i=document.createElement("div"),e=i.style;i.classList.add("wmyee3de6e8cdfe4797"),i.dataset.until=t.until,e.margin=t.margin;for(let e=1;e<=t.columns;e++){1<e&&((o=document.createElement("div")).classList.add("wmyaa0619fd4c759984"),o.style.width=t.gutter,o.style.background=t.gutterColor,i.appendChild(o));var o=document.createElement("div");o.classList.add("wmy0d725b29006c92b8"),o.style.width=100/t.columns+"%",o.style.background=t.columnColor,i.appendChild(o)}a.appendChild(i)}),a.id=this.id,this.DOMElement=a,this.windowResized(),this}windowResized(){var t=window.innerWidth,i=this.#config.breakpoints.map(e=>parseInt(e.until));i.sort,i.unshift(0),this.DOMElement.querySelectorAll(".wmyee3de6e8cdfe4797[data-until]").forEach(e=>{e.classList.remove("wmy7a2ba96f3534d166")});for(let e=0;e<i.length-1;e++){var o=i[e],a=i[e+1];if(o<=t&&t<=a){this.DOMElement.querySelector(`.wmyee3de6e8cdfe4797[data-until='${a}']`).classList.add("wmy7a2ba96f3534d166");break}}}}class WebmetryMeasurementTape{id;DOMElement;#config;#DOMgripA;#DOMgripB;#connector;#offset;#currentGrip;#points;#aBase;#bBase;constructor(e){this.id=window.__webmetry.generateId(),this.#config=e,this.#points={a:{x:0,y:0},b:{x:0,y:0}};var e=document.createElement("div"),t=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div"),a=document.createElement("div"),d=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div"),c=document.createElement("div"),l=document.createElement("div"),m=document.createElement("div"),f=document.createElement("div"),b=document.createElement("div");return e.classList.add("wmy562c949710db855a"),t.classList.add("wmy01618e03436f8fe0","wmy7fee32216e57e354"),i.classList.add("wmy01618e03436f8fe0","wmy3b5243bcbb9ff2fb"),o.classList.add("wmyac96bfe822223de4","wmy03a518dbd7620fc7","wmye68ce8371f2f2e41"),a.classList.add("wmyac96bfe822223de4","wmy149ba45d98b0dec2","wmye68ce8371f2f2e41"),n.classList.add("wmyac96bfe822223de4","wmy03a518dbd7620fc7","wmy75e8c33604436ea9"),r.classList.add("wmyac96bfe822223de4","wmy149ba45d98b0dec2","wmy75e8c33604436ea9"),d.classList.add("wmyac96bfe822223de4","wmy03a518dbd7620fc7","wmye68ce8371f2f2e41"),s.classList.add("wmyac96bfe822223de4","wmy149ba45d98b0dec2","wmye68ce8371f2f2e41"),c.classList.add("wmyac96bfe822223de4","wmy03a518dbd7620fc7","wmy75e8c33604436ea9"),l.classList.add("wmyac96bfe822223de4","wmy149ba45d98b0dec2","wmy75e8c33604436ea9"),m.classList.add("wmybacbcea281e6b523","wmy7fee32216e57e354"),f.classList.add("wmybacbcea281e6b523","wmy3b5243bcbb9ff2fb"),b.classList.add("wmyc45f8933b9fa0376"),b.style.background=this.#config.tapeColor,t.style.background=this.#config.gripColor,i.style.background=this.#config.gripColor,[o,a,d,s].forEach(e=>{e.style.background=this.#config.fixedGuideColor}),[n,r,c,l].forEach(e=>{e.style.background=this.#config.orientedGuideColor}),m.append(r,n),f.append(l,c),t.append(a,o,m),i.append(s,d,f),e.append(t,i,b),e.id=this.id,this.DOMElement=e,this.#DOMgripA=t,this.#DOMgripB=i,this.#connector=b,this.#aBase=m,this.#bBase=f,this}forceMove(e,t,i){this.#offset={x:0,y:0},this.#currentGrip=e,this.mouseMove({clientX:t,clientY:i})}mouseDown(e){this.#offset={x:e.offsetX,y:e.offsetY},this.#currentGrip=e.target.classList.contains("wmy7fee32216e57e354")?"a":"b",e.target.classList.add("wmyc41fc8773129ab03")}mouseUp(e){[this.#DOMgripA,this.#DOMgripB].forEach(e=>{e.classList.remove("wmyc41fc8773129ab03")})}mouseMove(e){this.#points[this.#currentGrip]={x:e.clientX-this.#offset.x,y:e.clientY-this.#offset.y},this.#update()}#update(){var e=this.#points,t="a"===this.#currentGrip?this.#DOMgripA:this.#DOMgripB,i=t.clientWidth/2,o=e[this.#currentGrip],a=this.#connector.style,t=(t.style.left=o.x-i+"px",t.style.top=o.y-i+"px",{}),o=(e.a.y>e.b.y?(t.top=e.b,t.bottom=e.a):(t.top=e.a,t.bottom=e.b),e.a.x>e.b.x?(t.left=e.b,t.right=e.a):(t.left=e.a,t.right=e.b),t.right.x-t.left.x),i=t.bottom.y-t.top.y,d=Math.abs(e.b.x-e.a.x),e=Math.abs(e.b.y-e.a.y);let s=180*Math.atan2(e,d)/Math.PI;for(;360<=s;)s-=360;for(;s<0;)s+=360;d=Math.sqrt(Math.pow(d,2)+Math.pow(e,2));a.width=d+"px",a.top=t.top.y+i/2+"px",a.left=t.left.x+o/2+"px",a.transform=`translate(-50%, -50%) rotate(${t.top.x>t.left.x?-s:s}deg)`,s*=t.top.x>t.left.x?-1:1,this.#aBase.style.transform=`rotate(${s}deg)`,this.#bBase.style.transform=`rotate(${s}deg)`,this.#connector.dataset.angle=Math.round(Math.abs(s),2)+"Â°",this.#connector.dataset.distance=Math.round(d,1)+"px"}}class Webmetry{#tools;#overlay;#config;#holdData;#lastInteractedTool;#fixedGrid;#infoElement;constructor(){this.#tools={},this.#holdData=null,this.#lastInteractedTool=null,this.#fixedGrid=null,this.#buildConfig(),this.#install()}toggleGrid(){var e;null===this.#fixedGrid?(e=new WebmetryGrid(this.#config.grid),this.#overlay.appendChild(e.DOMElement),this.#tools[e.id]=e,this.#fixedGrid=e):(this.#fixedGrid.DOMElement.remove(),delete this.#tools[this.#fixedGrid.id],this.#fixedGrid=null)}addAxleSet(){var e=new WebmetryAxle("vertical",this.#config.axle),e=(this.#overlay.appendChild(e.DOMElement),this.#tools[e.id]=e,new WebmetryAxle("horizontal",this.#config.axle));this.#overlay.appendChild(e.DOMElement),this.#tools[e.id]=e}addMeasurementTape(){var e=window.innerWidth/2,t=window.innerHeight/2,i=new WebmetryMeasurementTape(this.#config.measurementTape);this.#overlay.appendChild(i.DOMElement),(this.#tools[i.id]=i).forceMove("a",e-100,t),i.forceMove("b",100+e,t)}#windowResized(){Object.keys(this.#tools).forEach(e=>{e=this.#tools[e];e instanceof WebmetryGrid&&e.windowResized()})}#mouseMove(e){var t;null!==this.#holdData&&"function"==typeof(t=this.#tools[this.#holdData.toolId]).mouseDown&&t.mouseMove(e)}#mouseUp(t){null!==this.#holdData?this.#lastInteractedTool=this.#tools[this.#holdData.toolId]:this.#lastInteractedTool=null,Object.keys(this.#tools).forEach(e=>{e=this.#tools[e];"function"==typeof e.mouseUp&&e.mouseUp(t)}),this.#holdData=null}#mouseDown(t){if(t.target.classList.contains("wmy01618e03436f8fe0")){let e=t.target.parentElement;for(;""===e.id;){var i=e.parentElement;if(null===i)return;e=i}var o=this.#tools[e.id];"function"==typeof o.mouseDown&&o.mouseDown(t),this.#holdData={element:t.target,toolId:e.id}}}#keyPressed(e){if(e.ctrlKey||e.shiftKey)switch(e.key){case"O":var t=this.#overlay.classList;t.contains("wmy7a2ba96f3534d166")?t.remove("wmy7a2ba96f3534d166"):t.add("wmy7a2ba96f3534d166");break;case"A":this.addAxleSet();break;case"T":this.addMeasurementTape();break;case"G":this.toggleGrid();break;case"R":null!==this.#lastInteractedTool&&(t=this.#lastInteractedTool.id,this.#lastInteractedTool.DOMElement.remove(),delete this.#tools[t])}}#configToObject(e){let t={};return e.split(";").forEach(e=>{e=e.split(":");t[(e[0]||"").trim()]=(e[1]||"").trim()}),t}#buildConfig(){var e=this.#configToObject(document.currentScript.dataset?.axleConfig),t=(this.#configToObject(document.currentScript.dataset?.measurementTapeConfig),(document.currentScript.dataset?.gridConfig||"").split("|").map(e=>{e=this.#configToObject(e);return{until:e.until||800,columns:e.columns||12,gutter:e.gutter||"4px",margin:e.margin||"2px",gutterColor:e.gutterColor||"rgba(0,0,0,.6)",columnColor:e.columnColor||"rgba(0,0,0,.4)"}}));this.#config={grid:{breakpoints:t},axle:{color:e.axleColor||"rgba(0,0,0,.3)",gripColor:e.gripColor||"rgba(190,0,0,1)"},measurementTape:{tapeColor:e.tapeColor||"rgba(0,0,0,.3)",gripColor:e.gripColor||"rgba(190,0,0,.3)",fixedGuideColor:e.fixedGuideColor||"rgba(190,0,0,.8)",orientedGuideColor:e.orientedGuideColor||"rgba(0,0,190,.8)"}}}#install(){this.#overlay=document.createElement("div"),this.#overlay.classList.add("wmy2a7ee462a3eac7de","wmy7a2ba96f3534d166"),document.body.appendChild(this.#overlay);var e=document.createElement("style");e.innerHTML=".wmy2a7ee462a3eac7de,.wmyc18698ef93e5c70f,.wmyee3de6e8cdfe4797,.wmy562c949710db855a {   position: fixed;   top: 0; left: 0; right: 0; bottom: 0; }  .wmy2a7ee462a3eac7de * {   user-select: none; }  .wmy2a7ee462a3eac7de {   z-index: 9999999;   display: none; }  .wmy2a7ee462a3eac7de.wmy7a2ba96f3534d166 {   display: block; }  .wmyc18698ef93e5c70f {   pointer-events: none;   z-index: 500; }  .wmyee3de6e8cdfe4797 {   display: flex;   opacity: 0; }  .wmyee3de6e8cdfe4797.wmy7a2ba96f3534d166 {   opacity: 1; }  .wmye97e6d5692db2111 {   position: fixed;   user-select: none;   z-index: 600; }  .wmye97e6d5692db2111.wmy149ba45d98b0dec2 {   top: 0; left: 0; right: 0;   height: 10px; }  .wmye97e6d5692db2111.wmy03a518dbd7620fc7 {   top: 0; left: 0; bottom: 0;   width: 10px; }  .wmycd7070bb1d3b5af9, .wmy01618e03436f8fe0 {   position: absolute; }  .wmycd7070bb1d3b5af9 {   z-index: 100; }  .wmy01618e03436f8fe0 {   pointer-events: all;   cursor: pointer;   z-index: 200; }  .wmye97e6d5692db2111.wmy149ba45d98b0dec2 .wmycd7070bb1d3b5af9 {   top: 50%; left: 0; right: 0;   transform: translateY(-50%);   height: 1px;   mix-blend-mode: difference; }  .wmye97e6d5692db2111.wmy03a518dbd7620fc7 .wmycd7070bb1d3b5af9 {   top: 0; left: 50%; bottom: 0;   transform: translateX(-50%);   width: 1px;   mix-blend-mode: difference; }  .wmye97e6d5692db2111.wmy149ba45d98b0dec2 .wmy01618e03436f8fe0 {   top: 0; bottom: 0;   width: 8px;   mix-blend-mode: difference; }  .wmye97e6d5692db2111.wmy03a518dbd7620fc7 .wmy01618e03436f8fe0 {   left: 0; right: 0;   height: 8px;   mix-blend-mode: difference; }  .wmye97e6d5692db2111.wmy149ba45d98b0dec2 .wmy01618e03436f8fe0.wmy7fee32216e57e354 {   left: 0;   border-top-right-radius: 3px;   border-bottom-right-radius: 3px; }  .wmye97e6d5692db2111.wmy149ba45d98b0dec2 .wmy01618e03436f8fe0.wmy3b5243bcbb9ff2fb {   right: 0;   border-top-left-radius: 3px;   border-bottom-left-radius: 3px; }  .wmye97e6d5692db2111.wmy03a518dbd7620fc7 .wmy01618e03436f8fe0.wmy7fee32216e57e354 {   top: 0;   border-bottom-left-radius: 3px;   border-bottom-right-radius: 3px; }  .wmye97e6d5692db2111.wmy03a518dbd7620fc7 .wmy01618e03436f8fe0.wmy3b5243bcbb9ff2fb {   bottom: 0;   border-top-left-radius: 3px;   border-top-right-radius: 3px; }  .wmye97e6d5692db2111 .wmy5f95c9d751a2afd5 {   pointer-events: none;   display: inline-block;   position: absolute;   font-family: monospace;   font-size: 8px;   color: black;   mix-blend-mode: difference;   top: 50%;   left: 50%;   transition: transform 200ms 50ms ease-in-out; }  .wmye97e6d5692db2111.wmy03a518dbd7620fc7 .wmy5f95c9d751a2afd5 {   top: 50%; }  .wmye97e6d5692db2111.wmy149ba45d98b0dec2 .wmy5f95c9d751a2afd5 {   left: 50%; }  .wmy562c949710db855a {   pointer-events: none;   z-index: 700; }  .wmy562c949710db855a .wmy01618e03436f8fe0 {   border-radius: 50%;   opacity: 0.3;   width: 8px;   height: 8px;   position: absolute; }  .wmy562c949710db855a .wmy01618e03436f8fe0.wmyc41fc8773129ab03 .wmyac96bfe822223de4.wmye68ce8371f2f2e41 {   width: 80px;   opacity: 1; }  .wmy562c949710db855a .wmy01618e03436f8fe0.wmyc41fc8773129ab03 .wmyac96bfe822223de4.wmy75e8c33604436ea9 {   width: 100vw;   opacity: 1; }  .wmy562c949710db855a .wmyc45f8933b9fa0376 {   position: absolute;   height: 1px;   transform-origin: center center; }  .wmy562c949710db855a .wmyc45f8933b9fa0376::after, .wmy562c949710db855a .wmyc45f8933b9fa0376::before {   display: block;   position: absolute;   left: 50%;   transform: translateX(-50%);   font-family: monospace;   font-size: 8px;   mix-blend-mode: difference; }  .wmy562c949710db855a .wmyc45f8933b9fa0376::after {   bottom: 4px;   content: attr(data-angle); }  .wmy562c949710db855a .wmyc45f8933b9fa0376::before {   top: 4px;   content: attr(data-distance); }  .wmy562c949710db855a .wmyac96bfe822223de4 {   position: absolute;   height: 1px;   mix-blend-mode: difference;   width: 25px;   top: 50%;   left: 50%;   transform: translate(-50%, -50%);   pointer-events: none;   opacity: 0.5;   transition: width 150ms ease-in-out, height 150ms ease-in-out, opacity, 150ms ease-in-out; }  .wmy562c949710db855a .wmyac96bfe822223de4.wmy03a518dbd7620fc7 {   transform: translate(-50%, -50%) rotate(90deg); }  .wmy562c949710db855a .wmybacbcea281e6b523 {   position: absolute;   width: 100%;   height: 100%;   pointer-events: none; }  .wmyb059524ed6fd9aaa {   position: fixed;   bottom: 4px;   left: 4px;   color: black;   mix-blend-mode: difference;   font-family: monospace;   font-size: 10px; }",document.body.appendChild(e),window.addEventListener("resize",this.#windowResized.bind(this)),document.addEventListener("mousemove",this.#mouseMove.bind(this)),document.addEventListener("mouseup",this.#mouseUp.bind(this)),document.addEventListener("mousedown",this.#mouseDown.bind(this)),window.addEventListener("keyup",this.#keyPressed.bind(this)),this.#infoElement=document.createElement("div"),this.#infoElement.classList.add("wmyb059524ed6fd9aaa"),this.#infoElement.innerHTML="<b>webmetry</b> availale<br/><br/>",this.#infoElement.innerHTML+="<b>CTRL+SHIFT+O:</b> Toggle overlay<br/>",this.#infoElement.innerHTML+="<b>CTRL+SHIFT+A:</b> Add axles set<br/>",this.#infoElement.innerHTML+="<b>CTRL+SHIFT+T:</b> Add measurement tape<br/>",this.#infoElement.innerHTML+="<b>CTRL+SHIFT+G:</b> Toggle grid<br/>",this.#infoElement.innerHTML+="<b>CTRL+SHIFT+R:</b> Remove last interacted tool",document.body.appendChild(this.#infoElement),window.setTimeout(()=>{this.#infoElement.remove()},5e3)}}window.__webmetry.core=new Webmetry;